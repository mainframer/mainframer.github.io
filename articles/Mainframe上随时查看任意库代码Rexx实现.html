<!DOCTYPE html>
<head>
    <meta charset="utf-8" />
    <!-- Set the viewport width to device width for mobile -->
    <meta name="viewport" content="width=device-width" />

    <title>Mainframe上随时查看任意库代码Rexx实现</title>

    <link rel="stylesheet" href="http://mainframer.github.io/theme/css/normalize.css" />
    <link rel="stylesheet" href="http://mainframer.github.io/theme/css/foundation.min.css" />
    <link rel="stylesheet" href="http://mainframer.github.io/theme/css/style.css" />
    <link rel="stylesheet" href="http://mainframer.github.io/theme/css/pygments.css" />	
    <script src="http://mainframer.github.io/theme/js/modernizr.js"></script>
</head>

<body>

<!-- Nav Bar -->
<nav>
<div class="top-bar">
<div class="row">
    <div class="large-9 large-centered columns">
	    <h1><a href="http://mainframer.github.io">Modern Mainframer</a></h1>
    </div>
</div>
</div>

<!-- Show menu items and pages -->
<div class="row">
<div class="large-9 columns">
    <ul class="button-group navigation">

    </ul>
</div>
</div>
</nav>
<!-- End Nav -->


<!-- Main Page Content and Sidebar -->
<div class="row">

    <!-- Main Blog Content -->
    <div class="large-9 columns">
<article>
    <header>
        <h3 class="article-title"><a href="http://mainframer.github.io/articles/Mainframe上随时查看任意库代码Rexx实现.html" rel="bookmark"
        title="Permalink to Mainframe上随时查看任意库代码Rexx实现">Mainframe上随时查看任意库代码Rexx实现</a></h3>
    </header>

<h6 class="subheader" title="2012-11-12T00:00:00">2012-11-12
</h6>


    <p>Mainframe上面工作经常需要临时查看<em>Production</em>代码库当中的代码，又不希望输入长长的库名称。可以用REXX写一个<em>Retrieve</em>功能的脚本，放在
<code>USERID.REXX.EXEC</code>这个pds下面。运行的时候<strong><code>TSO RET your_program_name</code></strong> 即可随时查看。这里是这个RET程序的实现方法，原本是公司内部用的，由前辈们积累下来的财产，我见它有通用性和扩展性，故稍作修改简化后贴这里：
{% codeblock lang:python %} 
EDIT       IBMUSER.REXX.EXEC(RET) - 01.02                  Columns 00001 00072 
Command ===&gt;                                                  Scroll ===&gt; CSR<br />
<strong><em>*</em>* </strong><strong><em>*</em></strong><strong><em>*</em></strong><strong><em>*</em></strong><strong><em>*</em>* Top of Data </strong><strong><em>*</em></strong><strong><em>*</em></strong><strong><em>*</em></strong><strong><em>*</em></strong>
000001 /<em> rexx </em>/                                                            <br />
000002 /<strong><em>*</em></strong><strong><em>* ret - retrieve specific member from multiple libs</em></strong><em><br />
000004   dummy = outtrap("dummy2",0)      /<strong>*</strong>/
000003 arg member                                                            </em>suppress tso messages from screen <em>
000005   holdrc = 1;found_num=0;mem_arr.="";  /</em> init vars*/                 <br />
000006   call readlibs                                                       <br />
000007   if found_num &gt; 0 then                                               <br />
000008    do i=1 to found_num                                                <br />
000009       address ispexec "VIEW DATASET('"mem_arr.i"')"                   <br />
000010    end                                                                <br />
000011   else say "Can't find requested module --&gt;  "member                  <br />
000012 exit    </p>
<p>000013 /<em><em>readlibs: Here you can add any libs you want to search<strong><em>*</em></strong><strong><em>*</em></strong>/ <br />
000014 readlibs:                                                             <br />
000015   call search_one_lib "IBMUSER.SOURCE.LIB1"<br />
       /</em>if holdrc = 1 then call your_added_lib1  add your extra lib here</em>/
       /<em>if holdrc = 1 then call your_added_lib2  want to add another one?</em>/ 
         ...       <br />
000016 return  </p>
<p>000017 /<strong>search_one_lib: Browse and Find member from a designated lib<strong><em>*</em></strong></strong><em>/ <br />
000018 search_one_lib:                                                         <br />
000019  parse upper arg dsname                                               <br />
000020   dspds ="'"!!dsname!!"'"                                             <br />
000021   "ispexec lminit  dataid(handle)",                                   <br />
000022                  " dataset(" dspds ")"                                <br />
000023   "ispexec lmopen  dataid(" handle ") option(input)"                  <br />
000024   "ispexec lmmfind dataid(" handle ") member(" !! member !! ")",      <br />
000025                   "stats(yes)";                                       <br />
000026   if rc = 0 then do                                                   <br />
000027      dspds = dsname !! "(" !! member !! ")"                           <br />
000028      found_num = found_num + 1                                        <br />
000029      mem_arr.found_num = dspds                                        <br />
000030   end                                                                 <br />
000031    "ispexec  lmclose dataid(" handle ")"                              <br />
000032    "ispexec  lmfree  dataid(" handle ")"                              <br />
000033 return                                                                <br />
{% endcodeblock  %}
例如，你突然想看程序</em>PRODPGM1<em>,只需执行： 
{% blockquote %} 
TSO RET PRODPGM1 
{% endblockquote  %}
REXX程序就会去函数readlibs里面您事先指定好的libs里面查找</em>PRODPGM1<em>,然后以VIEW的方式逐个打开</em>PRODPGM1*供您查看。
{% codeblock lang:python %} 
  File  Edit  Edit_Settings  Menu  Utilities  Compilers  Test  Help          <br />
<code>``````````````````````````````````````````````````````````````````````````````
VIEW       IBMUSER.SOURCE.LIB1(PRODPGM1) - 03. Columns 00001 00072 
Command ===&gt;                                                  Scroll ===&gt; CSR  
****** ***************************** Top of Data ******************************
000001   PRODPGM1: PROC(PARMS) OPTIONS(MAIN);                          
000002  /*********************************************************************/
000003  /* PROGRAM-ID:  PRODPGM1                                             */
000004  /* DESCRIPTION: PRODUCE DAILY SUMMARY RPT                            */
000005  /* AUTHOR:      IBMUSER JOHN                                         */
000006  /* DATE:        JUNE 2009                                            */
000007  /*********************************************************************/
{% endcodeblock  %}
如果*PRODPGM1*还存在于除了</code>IBMUSER.SOURCE.LIB1`之外的lib中，那么按PF3即可接着查看下一个结果。</p>
<p class="subheader">Category: <a href="http://mainframer.github.io/category/articles.html">articles</a>

    Tagged: 
    <a href="http://mainframer.github.io/tag/zos.html">z/OS </a>
</p>




	<h4>Comments</h4>
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        var disqus_shortname = 'mainframer'
        var disqus_identifier = "articles/Mainframe上随时查看任意库代码Rexx实现.html";
        var disqus_url = "http://mainframer.github.io/articles/Mainframe上随时查看任意库代码Rexx实现.html";

        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</article>
    </div>
    <!-- End Main Content -->

    <!-- Sidebar -->
    <aside class="large-3 columns">
        <h5 class="sidebar-title">Site</h5>
        <ul class="side-nav">
            <li><a href="http://mainframer.github.io/archives.html">Archives</a>
            <li><a href="http://mainframer.github.io/tags.html">Tags</a>
        </ul>

		
        <h5 class="sidebar-title">Categories</h5>
        <ul class="side-nav">
            <li><a href="http://mainframer.github.io/category/articles.html">articles</a></li>
   
        </ul>

        <h5 class="sidebar-title">Links</h5>
        <ul class="side-nav">
            <li><a href="http://getpelican.com/">Pelican</a></li>
            <li><a href="http://python.org/">Python.org</a></li>
            <li><a href="http://jinja.pocoo.org/">Jinja2</a></li>
            <li><a href="#">You can modify those links in your config file</a></li>
        </ul>
		
        <h5 class="sidebar-title">Social</h5>
        <ul class="side-nav">
            <li><a href="https://github.com/mainframer">Github</a></li>
            <li><a href="https://www.linkedin.com/in/mainframer">Linkedin</a></li>
        </ul>

    </aside> <!-- End Sidebar -->

</div> <!-- End Main Content and Sidebar -->


<!-- Footer -->
<footer class="row">
    <div class="large-12 columns">
        <hr />
        <div class="row">
            <div class="large-6 columns">
              <!--                  <p>Modern Mainframer by mainframer</p> -->
            </div>
            </div>
    </div>
</footer>
</body>
</html>